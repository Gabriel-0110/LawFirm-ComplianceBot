[
  {
    "Timestamp": "02:45:00",
    "TestName": "Service Availability",
    "Status": "PASS",
    "Message": "Production service is reachable",
    "Details": 200
  },
  {
    "Timestamp": "02:45:00",
    "TestName": "HTTPS Enforcement",
    "Status": "PASS",
    "Message": "Service enforces HTTPS",
    "Details": null
  },
  {
    "Timestamp": "02:45:00",
    "TestName": "Security Header: Strict-Transport-Security",
    "Status": "PASS",
    "Message": "Present: max-age=2592000",
    "Details": null
  },
  {
    "Timestamp": "02:45:00",
    "TestName": "Security Header: X-Content-Type-Options",
    "Status": "PASS",
    "Message": "Present: nosniff",
    "Details": null
  },
  {
    "Timestamp": "02:45:00",
    "TestName": "Security Header: X-Frame-Options",
    "Status": "PASS",
    "Message": "Present: DENY",
    "Details": null
  },
  {
    "Timestamp": "02:45:00",
    "TestName": "Bot Configuration",
    "Status": "PASS",
    "Message": "HTTP 200 (112ms)",
    "Details": {
      "name": "Teams Compliance Bot",
      "description": "Enterprise compliance recording bot for Microsoft Teams",
      "version": "1.0.0.0",
      "buildDate": "2025-06-26T16:31:04-04:00",
      "status": "Running",
      "environment": "Production",
      "endpoints": {
        "botMessages": "/api/messages",
        "notifications": "/api/notifications",
        "calls": "/api/calls",
        "health": "/health",
        "info": "/info"
      },
      "configuration": {
        "botId": "153a***6699",
        "tenantId": "5902***d47c",
        "appType": "MultiTenant"
      },
      "correlationId": "9a4bfdea-0504-4722-bc1c-b2a1409aecfc",
      "timestamp": "2025-06-29T06:45:01Z"
    }
  },
  {
    "Timestamp": "02:45:00",
    "TestName": "Environment Mode",
    "Status": "PASS",
    "Message": "Running in Production mode",
    "Details": "Production"
  },
  {
    "Timestamp": "02:45:00",
    "TestName": "Config: botId",
    "Status": "PASS",
    "Message": "Configured: 153a***6699",
    "Details": null
  },
  {
    "Timestamp": "02:45:00",
    "TestName": "Config: tenantId",
    "Status": "PASS",
    "Message": "Configured: 5902***d47c",
    "Details": null
  },
  {
    "Timestamp": "02:45:00",
    "TestName": "Config: appType",
    "Status": "PASS",
    "Message": "Configured: MultiTenant",
    "Details": null
  },
  {
    "Timestamp": "02:45:02",
    "TestName": "Graph API Connectivity",
    "Status": "PASS",
    "Message": "HTTP 200 (1285ms)",
    "Details": {
      "status": "completed",
      "timestamp": "2025-06-29T02:45:02.6300459-04:00",
      "results": [
        "ℹ️ Delegated Auth: /me request is only valid with delegated authentication flow. (Expected with app-only auth)",
        "✅ List Calls: Found 0 calls",
        "✅ Communications Access: Success",
        "ℹ️ Answer Test Error: UnknownError - "
      ]
    }
  },
  {
    "Timestamp": "02:45:02",
    "TestName": "Graph Authentication",
    "Status": "PASS",
    "Message": "App-only authentication working correctly",
    "Details": "ℹ️ Delegated Auth: /me request is only valid with delegated authentication flow. (Expected with app-only auth)"
  },
  {
    "Timestamp": "02:45:02",
    "TestName": "Communications API Access",
    "Status": "PASS",
    "Message": "Can access Microsoft Graph Communications",
    "Details": "✅ Communications Access: Success"
  },
  {
    "Timestamp": "02:45:02",
    "TestName": "Calls API Access",
    "Status": "PASS",
    "Message": "Can access Calls API",
    "Details": "✅ List Calls: Found 0 calls"
  },
  {
    "Timestamp": "02:45:02",
    "TestName": "Answer API Test",
    "Status": "PASS",
    "Message": "Answer API working (test error expected)",
    "Details": "ℹ️ Answer Test Error: UnknownError - "
  },
  {
    "Timestamp": "02:45:02",
    "TestName": "Overall Graph API Status",
    "Status": "PASS",
    "Message": "Graph API integration working (2 successful tests)",
    "Details": [
      "ℹ️ Delegated Auth: /me request is only valid with delegated authentication flow. (Expected with app-only auth)",
      "✅ List Calls: Found 0 calls",
      "✅ Communications Access: Success",
      "ℹ️ Answer Test Error: UnknownError - "
    ]
  },
  {
    "Timestamp": "02:45:02",
    "TestName": "Teams Meeting Join Request",
    "Status": "PASS",
    "Message": "HTTP 200 (203ms)",
    "Details": {
      "status": "acknowledged",
      "callId": null,
      "state": null
    }
  },
  {
    "Timestamp": "02:45:02",
    "TestName": "Call State - Established",
    "Status": "PASS",
    "Message": "HTTP 200 (179ms)",
    "Details": {
      "status": "acknowledged",
      "callId": null,
      "state": null
    }
  },
  {
    "Timestamp": "02:45:02",
    "TestName": "Call Recording Started",
    "Status": "PASS",
    "Message": "HTTP 200 (229ms)",
    "Details": {
      "status": "acknowledged",
      "callId": null,
      "state": null
    }
  },
  {
    "Timestamp": "02:45:03",
    "TestName": "Production Auto-Answer Test",
    "Status": "PASS",
    "Message": "HTTP 200 (605ms)",
    "Details": {
      "testResult": {
        "status": "answer_failed",
        "error": "Graph API error: Call not found. (8522) - No additional details",
        "errorCode": "8522",
        "callId": "prod-auto-001"
      },
      "correlationId": "05f58d23-6932-46db-9ca8-3100033592e6",
      "callData": {
        "id": "prod-auto-001",
        "state": "incoming",
        "direction": "incoming",
        "source": "@{identity=}",
        "callbackUri": "https://arandiabot-app.azurewebsites.net/api/calls"
      },
      "timestamp": "2025-06-29T02:45:04.0952404-04:00"
    }
  },
  {
    "Timestamp": "02:45:03",
    "TestName": "Production Auto-Answer Test - Expected",
    "Status": "PASS",
    "Message": "Auto-answer logic working (test call not found is expected)",
    "Details": {
      "status": "answer_failed",
      "error": "Graph API error: Call not found. (8522) - No additional details",
      "errorCode": "8522",
      "callId": "prod-auto-001"
    }
  },
  {
    "Timestamp": "02:45:03",
    "TestName": "E2E - Incoming Call",
    "Status": "PASS",
    "Message": "HTTP 200 (152ms)",
    "Details": {
      "status": "acknowledged",
      "callId": null,
      "state": null
    }
  },
  {
    "Timestamp": "02:45:05",
    "TestName": "E2E - Call Established",
    "Status": "PASS",
    "Message": "HTTP 200 (147ms)",
    "Details": {
      "status": "acknowledged",
      "callId": null,
      "state": null
    }
  },
  {
    "Timestamp": "02:45:05",
    "TestName": "E2E Workflow",
    "Status": "PASS",
    "Message": "Complete call workflow simulation successful",
    "Details": null
  },
  {
    "Timestamp": "02:45:05",
    "TestName": "Azure Queries",
    "Status": "INFO",
    "Message": "Skipped - use -IncludeAzureQueries to include Azure log queries",
    "Details": null
  },
  {
    "Timestamp": "02:45:05",
    "TestName": "Azure Resource Check",
    "Status": "INFO",
    "Message": "Skipped - use -IncludeAzureQueries to include Azure resource queries",
    "Details": null
  }
]
